<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="测试你记忆数字序列的能力，了解你的短期记忆与他人相比如何">
    <title>数字记忆测试 | BrainBenchmark</title>
    <!-- 基本样式内联，确保即使CSS未加载也能正常显示 -->
    <style>
        /* 基本内联样式 */
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 0; 
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 20px; 
        }
        header { 
            background-color: #2962ff; 
            color: white; 
            padding: 1rem 0; 
        }
        .logo-link { 
            color: white; 
            text-decoration: none; 
            font-size: 1.5rem; 
            font-weight: bold;
        }
        main { 
            padding: 2rem 0; 
        }
        .game-screen { 
            display: none; 
            text-align: center;
        }
        .game-screen.active { 
            display: block; 
        }
        #game-container { 
            background: white; 
            border-radius: 8px; 
            padding: 2rem; 
            margin: 2rem auto; 
            max-width: 600px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #2962ff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
        }
        .btn:hover {
            background-color: #0039cb;
        }
        .result-message {
            display: none;
        }
        .result-message.active {
            display: block;
        }
        input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
            max-width: 300px;
        }
        #timer-bar {
            width: 100%;
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1rem;
        }
        #timer-progress {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #2962ff, #82b1ff);
            transform-origin: left;
            animation: timerShrink 7s linear forwards;
        }
        @keyframes timerShrink {
            from { transform: scaleX(1); }
            to { transform: scaleX(0); }
        }
        #number-to-remember {
            font-size: 3rem;
            font-weight: bold;
            margin: 2rem 0;
            display: block;
            color: #2962ff;
            font-family: 'Courier New', monospace;
        }
        .debug-info {
            background-color: #ffeb3b;
            color: #333;
            padding: 5px 10px;
            position: fixed;
            top: 0;
            right: 0;
            z-index: 9999;
            font-size: 12px;
        }
    </style>
    <!-- 先加载外部CSS -->
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="./number-memory.css">
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    
    <!-- 页面内容可见性修复 -->
    <script>
        // 确保页面内容始终可见
        document.addEventListener('DOMContentLoaded', function() {
            document.body.style.opacity = "1";
            document.body.style.transform = "none";
            setTimeout(function() {
                if (getComputedStyle(document.body).opacity !== "1") {
                    document.body.setAttribute('style', 'opacity: 1 !important; transform: none !important');
                }
            }, 500);
        });
    </script>
</head>
<body>
    <div id="debug-panel" class="debug-info" style="display:none;" onclick="this.style.display='none';">调试模式</div>

    <header>
        <div class="container">
            <h1><a href="index.html" class="logo-link">BrainBenchmark</a></h1>
            <p class="tagline">测试并提升你的认知能力</p>
        </div>
    </header>

    <main class="container">
        <section class="test-info">
            <h2>数字记忆测试</h2>
            <div class="test-description">
                <p>测试你的短期记忆能力。系统会显示一个数字序列，你需要记住并正确输入它。</p>
                <p>每答对一题，数字长度会增加一位。答错则游戏结束，显示你的最终成绩。</p>
            </div>
            
            <div class="test-stats">
                <div class="stat-item">
                    <span class="stat-value">7位</span>
                    <span class="stat-label">平均水平</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">10位</span>
                    <span class="stat-label">前10%的成绩</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">14位</span>
                    <span class="stat-label">前1%的成绩</span>
                </div>
            </div>
            
            <div class="test-tips">
                <h3>提升技巧</h3>
                <ul>
                    <li>尝试将数字分组记忆，例如将"1234567"分为"123-45-67"</li>
                    <li>创建数字与熟悉事物的联系，如生日、重要日期等</li>
                    <li>专注并避免分心，找一个安静的环境</li>
                </ul>
            </div>
            
            <a href="index.html" class="btn back-btn">返回首页</a>
        </section>

        <section class="test-area">
            <div id="game-container">
                <div class="game-info">
                    <span>当前级别: </span>
                    <span id="current-level">1</span>
                </div>
                
                <!-- 游戏屏幕容器 -->
                <div id="game-screens">
                    <!-- 开始屏幕 -->
                    <div id="start-screen" class="game-screen active">
                        <h3>数字记忆测试</h3>
                        <p>准备好挑战你的记忆能力了吗？</p>
                        <button id="start-btn" class="btn">开始测试</button>
                    </div>
                    
                    <!-- 显示数字屏幕 -->
                    <div id="number-display-screen" class="game-screen">
                        <h3>记住这个数字</h3>
                        <div class="number-container">
                            <span id="number-to-remember">5</span>
                        </div>
                        <div id="timer-bar">
                            <div id="timer-progress"></div>
                        </div>
                    </div>
                    
                    <!-- 输入数字屏幕 -->
                    <div id="number-input-screen" class="game-screen">
                        <h3>请输入你记住的数字</h3>
                        <div class="input-container">
                            <input type="text" id="number-input" inputmode="numeric" pattern="[0-9]*" autocomplete="off">
                            <button id="submit-btn" class="btn">提交</button>
                        </div>
                    </div>
                    
                    <!-- 结果屏幕 -->
                    <div id="result-screen" class="game-screen">
                        <div id="success-message" class="result-message">
                            <h3>正确!</h3>
                            <p>进入下一级</p>
                        </div>
                        <div id="failure-message" class="result-message">
                            <h3>很遗憾!</h3>
                            <p>正确答案: <span id="correct-number"></span></p>
                        </div>
                        <button id="continue-btn" class="btn">继续</button>
                    </div>
                    
                    <!-- 游戏结束屏幕 -->
                    <div id="game-over-screen" class="game-screen">
                        <h3>测试结束</h3>
                        <div class="final-result">
                            <p>你的最高级别: <span id="final-level" class="highlight"></span></p>
                            <p>你能记住 <span id="final-digits" class="highlight"></span> 位数字</p>
                            <div class="percentile-result">
                                <p>超过了 <span id="percentile" class="highlight"></span> 的用户</p>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button id="restart-btn" class="btn">重新开始</button>
                            <button id="share-btn" class="btn secondary">分享结果</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="results-area">
                <div class="history-container">
                    <h3>测试历史</h3>
                    <div id="history-list" class="history-list">
                        <!-- 历史记录将被JS动态添加 -->
                        <div class="history-item empty">暂无历史记录</div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 BrainBenchmark - 脑力基准测试平台</p>
            <nav class="footer-nav">
                <a href="#" class="footer-link">关于我们</a>
                <a href="#" class="footer-link">联系方式</a>
                <a href="#" class="footer-link">隐私政策</a>
            </nav>
        </div>
    </footer>

    <div id="toast" class="toast hidden">
        <span id="toast-message"></span>
    </div>

    <!-- 调试信息 -->
    <div id="debug-info" style="display: none;"></div>

    <!-- 先加载主JS文件 -->
    <script src="./number-memory.js"></script>
    
    <!-- 错误处理和修复脚本 -->
    <script>
        // 全局错误处理
        window.addEventListener('error', function(e) {
            console.error('页面错误:', e.message);
            // 尝试恢复基本功能
            document.body.style.opacity = "1";
            document.body.style.transform = "none";
            
            // 确保第一个屏幕可见
            const startScreen = document.getElementById('start-screen');
            if (startScreen) {
                startScreen.style.display = 'block';
            }
            
            // 确保按钮可点击
            const startBtn = document.getElementById('start-btn');
            if (startBtn) {
                startBtn.addEventListener('click', function() {
                    alert('游戏启动中，请等待...');
                    location.reload();
                });
            }
        });
        
        // 确保页面显示，5秒后检查
        setTimeout(function() {
            const startScreen = document.getElementById('start-screen');
            if (startScreen && getComputedStyle(startScreen).display === 'none' && !document.querySelector('.game-screen.active')) {
                startScreen.style.display = 'block';
                console.log('强制显示开始屏幕');
            }
        }, 5000);
    </script>
</body>
</html> 